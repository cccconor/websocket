package org.apache.jsp;

import javax.servlet.*;
import javax.servlet.http.*;
import javax.servlet.jsp.*;

public final class main_jsp extends org.apache.jasper.runtime.HttpJspBase
    implements org.apache.jasper.runtime.JspSourceDependent {

  private static final JspFactory _jspxFactory = JspFactory.getDefaultFactory();

  private static java.util.List<String> _jspx_dependants;

  private org.glassfish.jsp.api.ResourceInjector _jspx_resourceInjector;

  public java.util.List<String> getDependants() {
    return _jspx_dependants;
  }

  public void _jspService(HttpServletRequest request, HttpServletResponse response)
        throws java.io.IOException, ServletException {

    PageContext pageContext = null;
    HttpSession session = null;
    ServletContext application = null;
    ServletConfig config = null;
    JspWriter out = null;
    Object page = this;
    JspWriter _jspx_out = null;
    PageContext _jspx_page_context = null;

    try {
      response.setContentType("text/html;charset=UTF-8");
      pageContext = _jspxFactory.getPageContext(this, request, response,
      			null, true, 8192, true);
      _jspx_page_context = pageContext;
      application = pageContext.getServletContext();
      config = pageContext.getServletConfig();
      session = pageContext.getSession();
      out = pageContext.getOut();
      _jspx_out = out;
      _jspx_resourceInjector = (org.glassfish.jsp.api.ResourceInjector) application.getAttribute("com.sun.appserv.jsp.resource.injector");

      out.write("\n");
      out.write("\n");
      out.write("\n");
      out.write("<!DOCTYPE html>\n");
      out.write("<html lang=\"zh-CN\">\n");
      out.write("  <head>\n");
      out.write("      <link rel=\"stylesheet\" type=\"text/css\" href=\"bootstrap/css/bootstrap.css\">\n");
      out.write("      <link rel=\"stylesheet\" type=\"text/css\" href=\"bootstrap/css/bootstrap.min.css\">\n");
      out.write("    <meta charset=\"utf-8\">\n");
      out.write("    <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\n");
      out.write("    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\n");
      out.write("    <!-- 上述3个meta标签*必须*放在最前面，任何其他内容都*必须*跟随其后！ -->\n");
      out.write("    <title>Bootstrap 101 Template</title>\n");
      out.write("\n");
      out.write("    <!-- Bootstrap -->\n");
      out.write("    <!--<link href=\"https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/css/bootstrap.min.css\" rel=\"stylesheet\">-->\n");
      out.write("\n");
      out.write("    <!-- HTML5 shim 和 Respond.js 是为了让 IE8 支持 HTML5 元素和媒体查询（media queries）功能 -->\n");
      out.write("    <!-- 警告：通过 file:// 协议（就是直接将 html 页面拖拽到浏览器中）访问页面时 Respond.js 不起作用 -->\n");
      out.write("    <!--[if lt IE 9]\n");
      out.write("      <script src=\"https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js\"></script>\n");
      out.write("      <script src=\"https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js\"></script>\n");
      out.write("    <![endif]-->\n");
      out.write("  </head>\n");
      out.write("  <body>\n");
      out.write("          <script type=\"application/javascript\">\n");
      out.write("        var str = 'ws://' + window.location.host + '/examples/websocket/chat';\n");
      out.write("//        Console.log(str);\n");
      out.write("        var name = getQueryString(\"name\");\n");
      out.write("        var Chat = {};\n");
      out.write("        Chat.socket = null;\n");
      out.write("        Chat.connect = (function(host) {\n");
      out.write("            if ('WebSocket' in window) {\n");
      out.write("                Chat.socket = new WebSocket(host);\n");
      out.write("            } else if ('MozWebSocket' in window) {\n");
      out.write("                Chat.socket = new MozWebSocket(host);\n");
      out.write("            } else {\n");
      out.write("                Console.log('Error: WebSocket is not supported by this browser.');\n");
      out.write("                return;\n");
      out.write("            }\n");
      out.write("\n");
      out.write("            Chat.socket.onopen = function () {\n");
      out.write("                Console.log('Info: WebSocket connection opened.');\n");
      out.write("                onlineTip();\n");
      out.write("                document.getElementById('chat').onkeydown = function(event) {\n");
      out.write("                    if (event.keyCode == 13) {\n");
      out.write("                        Chat.sendMessage();\n");
      out.write("                    }\n");
      out.write("                };\n");
      out.write("            };\n");
      out.write("\n");
      out.write("            Chat.socket.onclose = function () {\n");
      out.write("                document.getElementById('chat').onkeydown = null;\n");
      out.write("                Console.log('Info: WebSocket closed.');\n");
      out.write("            };\n");
      out.write("            \n");
      out.write("            \n");
      out.write("            Chat.socket.onmessage = function (message) {\n");
      out.write("                var m = JSON.parse(message.data);\n");
      out.write("                if(parseInt(m.type)==0)\n");
      out.write("                {\n");
      out.write("                    addOne(m.from);\n");
      out.write("                    var msg = m.from.toString() + \"上线了\";\n");
      out.write("                    Console.log(msg);\n");
      out.write("                }else\n");
      out.write("                    \n");
      out.write("                if(parseInt(m.type)==-1)\n");
      out.write("                {\n");
      out.write("                    var msg = m.from.toString() + \"下线了\" ;\n");
      out.write("                    Console.log(msg);\n");
      out.write("                }else if(parseInt(m.type)==3)\n");
      out.write("                {\n");
      out.write("                    var msg = m.from.toString() + \"对你说：\" + m.content.toString() ;\n");
      out.write("//                    Console.log(msg);\n");
      out.write("                    addMsgList(msg);\n");
      out.write("\n");
      out.write("                }else\n");
      out.write("                {\n");
      out.write("                    var msg = m.from.toString() + \"对大家说： \" + m.content.toString() ;\n");
      out.write("                    Console.log(msg);\n");
      out.write("                }\n");
      out.write("//                alert(m.content);\n");
      out.write("\n");
      out.write("//                Console.log(message.data);\n");
      out.write("            };\n");
      out.write("        });\n");
      out.write("\n");
      out.write("        Chat.initialize = function() {\n");
      out.write("            if (window.location.protocol == 'http:') {\n");
      out.write("                Chat.connect('ws://' + window.location.host + '/websocket/chat');\n");
      out.write("            } else {\n");
      out.write("                Chat.connect('wss://' + window.location.host + '/websocket/chat');\n");
      out.write("            }\n");
      out.write("        };\n");
      out.write("\n");
      out.write("        Chat.sendMessage = (function() {            \n");
      out.write("            var message = document.getElementById('chat').value;\n");
      out.write("            var msg =JSON.stringify({\n");
      out.write("              type: 1,\n");
      out.write("              from: name,\n");
      out.write("              to: \"\",\n");
      out.write("              content: message\n");
      out.write("            });\n");
      out.write("            if (message != '') {\n");
      out.write("                Chat.socket.send(msg);\n");
      out.write("                document.getElementById('chat').value = '';\n");
      out.write("            }\n");
      out.write("        });\n");
      out.write("\n");
      out.write("        var Console = {};\n");
      out.write("\n");
      out.write("        Console.log = (function(message) {\n");
      out.write("            var console = document.getElementById('console');\n");
      out.write("            var p = document.createElement('p');\n");
      out.write("            p.style.wordWrap = 'break-word';\n");
      out.write("            p.innerHTML = message;\n");
      out.write("            console.appendChild(p);\n");
      out.write("            while (console.childNodes.length > 25) {\n");
      out.write("                console.removeChild(console.firstChild);\n");
      out.write("            }\n");
      out.write("            console.scrollTop = console.scrollHeight;\n");
      out.write("        });\n");
      out.write("        \n");
      out.write("        function addMsgList(msg)\n");
      out.write("        {\n");
      out.write("            var console = document.getElementById('console1');\n");
      out.write("            var p = document.createElement('p');\n");
      out.write("            p.style.wordWrap = 'break-word';\n");
      out.write("            p.innerHTML = msg;\n");
      out.write("            console.appendChild(p);\n");
      out.write("            while (console.childNodes.length > 25) {\n");
      out.write("                console.removeChild(console.firstChild);\n");
      out.write("            }\n");
      out.write("        }\n");
      out.write("            \n");
      out.write("\n");
      out.write("        Chat.initialize();\n");
      out.write("\n");
      out.write("\n");
      out.write("        document.addEventListener(\"DOMContentLoaded\", function() {\n");
      out.write("            // Remove elements with \"noscript\" class - <noscript> is not allowed in XHTML\n");
      out.write("            var noscripts = document.getElementsByClassName(\"noscript\");\n");
      out.write("            for (var i = 0; i < noscripts.length; i++) {\n");
      out.write("                noscripts[i].parentNode.removeChild(noscripts[i]);\n");
      out.write("            }\n");
      out.write("        }, false);\n");
      out.write("        \n");
      out.write("        onlineTip = function()\n");
      out.write("        {\n");
      out.write("            var msg =JSON.stringify({\n");
      out.write("              type:0,\n");
      out.write("              from: name,\n");
      out.write("              to: \"\",\n");
      out.write("              content:\"online\"\n");
      out.write("            });\n");
      out.write("            Chat.socket.send(msg);\n");
      out.write("        }\n");
      out.write("        \n");
      out.write("        \n");
      out.write("        function getQueryString(name) {\n");
      out.write("    var result = window.location.search.match(new RegExp(\"[\\?\\&]\" + name + \"=([^\\&]+)\", \"i\"));\n");
      out.write("    if (result == null || result.length < 1) {\n");
      out.write("        return \"\";\n");
      out.write("    }\n");
      out.write("    return result[1];\n");
      out.write("}\n");
      out.write("        function addOne(name)\n");
      out.write("        {\n");
      out.write("            var console = document.getElementById('friendlist');\n");
      out.write("            var p = document.createElement('input');\n");
      out.write("            var l = document.createElement(\"label\");\n");
      out.write("            l.style = \"display:inline\";\n");
      out.write("            l.name = \"'\"+name+\"'\" ;\n");
      out.write("            l.innerHTML = name + \"<br>\";\n");
      out.write("            p.type = \"radio\";\n");
      out.write("            p.name = \"list\";\n");
      out.write("            p.vaue = \"'\"+name+\"'\";\n");
      out.write("//            p.style.wordWrap = 'break-word';\n");
      out.write("//            p.innerHTML = name;\n");
      out.write("            console.appendChild(p);\n");
      out.write("            console.appendChild(l);\n");
      out.write("            while (console.childNodes.length > 25) {\n");
      out.write("                console.removeChild(console.firstChild);\n");
      out.write("            }\n");
      out.write("            console.scrollTop = console.scrollHeight;\n");
      out.write("        }\n");
      out.write("        \n");
      out.write("        function sendone()\n");
      out.write("        {\n");
      out.write("//            alert(\"sendone\");\n");
      out.write("            var toname = check();\n");
      out.write("            console.log(\"选中的人：\"+toname);\n");
      out.write("//            alert(toname);\n");
      out.write("            var str = document.getElementById(\"sendtoone\").value;\n");
      out.write("//            alert(toname+str);\n");
      out.write("            if(str==null||str==\"\")\n");
      out.write("            {\n");
      out.write("                alert(\"输入的消息为空\");\n");
      out.write("                return;\n");
      out.write("            }\n");
      out.write("            var msg =JSON.stringify({\n");
      out.write("              type: 3,\n");
      out.write("              from: name,\n");
      out.write("              to: toname,\n");
      out.write("              content: str\n");
      out.write("            });\n");
      out.write("            \n");
      out.write("            console.log(\"发送的消息：\"+msg);\n");
      out.write("            if (str != '') {\n");
      out.write("                Chat.socket.send(msg);\n");
      out.write("                document.getElementById('sendtoone').value = '';\n");
      out.write("            }\n");
      out.write("            \n");
      out.write("        }\n");
      out.write("        \n");
      out.write("        function check(){\n");
      out.write("\tvar radio = document.getElementsByName(\"list\");\n");
      out.write("\tfor (i=0; i<radio.length; i++) {\n");
      out.write("\t\tif (radio[i].checked) {\n");
      out.write("\t\t\treturn(radio[i].innerHTML)\n");
      out.write("\t\t}\n");
      out.write("\t}\n");
      out.write("}\n");
      out.write("    </script>\n");
      out.write("<div class=\"container-fluid\">\n");
      out.write("\t<div class=\"row-fluid\">\n");
      out.write("\t\t<div class=\"span12\">\n");
      out.write("\t\t\t<h3 class=\"text-center\">\n");
      out.write("\t\t\t\twebsocket实现的简易聊天系统\n");
      out.write("\t\t\t</h3>\n");
      out.write("\t\t</div>\n");
      out.write("\t</div>\n");
      out.write("\t<div class=\"row-fluid\">\n");
      out.write("\t\t<div class=\"span6\">\n");
      out.write("\t\t\t<h2>\n");
      out.write("\t\t\t\t私聊消息\n");
      out.write("\t\t\t</h2>\n");
      out.write("\t\t\t<p>\n");
      out.write("\t\t\t\t这里显示的是私聊消息：\n");
      out.write("\t\t\t</p>\n");
      out.write("\t\t\t<div id=\"console-container1\">\n");
      out.write("\t\t\t\t<div id=\"console1\">\n");
      out.write("                                                                            </div>\n");
      out.write("\n");
      out.write("\t\t\t</div>\n");
      out.write("\n");
      out.write("\t\t\t\n");
      out.write("                                                        <h3>在线用户：</h3>\n");
      out.write("                            \n");
      out.write("\t\t\t<div id=\"friendlist\">\n");
      out.write("\t\t\t</div>\n");
      out.write("                            \n");
      out.write("                                <form class=\"form-search\">\n");
      out.write("                                    <div id=\"sendToOne\">\n");
      out.write("\t\t\t\t<input class=\"input-medium search-query\" type=\"text\" id=\"sendtoone\" /> \n");
      out.write("                                <input value=\"发送消息\"  type=\"button\"class=\"btn\" onclick=\"sendone()\"/>\n");
      out.write("\t\t\t</div>\n");
      out.write("\t\t\t\t\n");
      out.write("\t\t\t</form>\n");
      out.write("\t\t</div>\n");
      out.write("\t\t<div class=\"span6\">\n");
      out.write("\t\t\t<h2>\n");
      out.write("\t\t\t\t群聊消息\n");
      out.write("\t\t\t</h2>\n");
      out.write("\t\t\t<p>\n");
      out.write("\t\t\t\t这里显示的是群聊消息\n");
      out.write("\t\t\t</p>\n");
      out.write("\t\t\t<div id=\"console-container\">\n");
      out.write("\t\t\t\t<div id=\"console\">\n");
      out.write("                                                                            </div>\n");
      out.write("\n");
      out.write("\t\t\t</div>\n");
      out.write("\t\t\t<form class=\"form-search\">\n");
      out.write("\t\t\t\t<input class=\"input-medium search-query\" type=\"text\" id=\"chat\" /> \n");
      out.write("                                <input type=\"button\" value=\"发送消息\" class=\"btn\" onclick=\"Chat.sendMessage()\"/>\n");
      out.write("\t\t\t</form>\n");
      out.write("\t\t</div>\n");
      out.write("\t</div>\n");
      out.write("</div>\n");
      out.write("</body>\n");
      out.write("</html>\n");
    } catch (Throwable t) {
      if (!(t instanceof SkipPageException)){
        out = _jspx_out;
        if (out != null && out.getBufferSize() != 0)
          out.clearBuffer();
        if (_jspx_page_context != null) _jspx_page_context.handlePageException(t);
        else throw new ServletException(t);
      }
    } finally {
      _jspxFactory.releasePageContext(_jspx_page_context);
    }
  }
}
